import{c as C,j as e,r as x}from"./assets/client-CAizLhZc.js";import{R as F,A as R,C as B,X as D,Y as L,T as $,a as O}from"./assets/AreaChart-DWmB5lgi.js";function E(i){const[t,a]=x.useState(()=>{var n;return(n=window.openai)==null?void 0:n[i]});return x.useEffect(()=>{const r=h=>{var p;const s=(p=window.openai)==null?void 0:p[i];s!==void 0&&(console.log(`[useOpenAiGlobal] ${i} updated:`,s),a(s))};window.addEventListener("openai:set_globals",r);const n=setInterval(()=>{var s;const l=(s=window.openai)==null?void 0:s[i];l!==void 0&&l!==t&&(console.log(`[useOpenAiGlobal] ${i} found via polling:`,l),a(l),clearInterval(n))},100);return()=>{window.removeEventListener("openai:set_globals",r),clearInterval(n)}},[i,t]),t}function M(){return E("toolOutput")}const P=({active:i,payload:t})=>{if(i&&t&&t.length){const a=t[0].payload,n=new Date(a.time*1e3).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n}),e.jsxs("div",{style:{fontSize:"14px",fontWeight:"bold"},children:["$",a.price.toFixed(2)]})]})}return null},G=({stockData:i,marketData:t,chartData:a})=>{const[r,n]=x.useState("1D"),[h,l]=x.useState(a),[s,p]=x.useState(!1),w=async o=>{p(!0),n(o);try{const d=await fetch(`https://hellostake.com/api/us/chart/${i.ticker}/${o}`,{method:"GET",credentials:"include",headers:{Accept:"application/json"}});if(d.ok){const A=(await d.json()).map(c=>({time:c[0]/1e3,price:c[4],open:c[1],high:c[2],low:c[3],volume:c[5]}));l(A)}}catch(d){console.error("Error fetching chart data:",d)}finally{p(!1)}},g=h.map(o=>o.price),k=g[g.length-1]||t.lastTrade,f=t.dailyReturnQuote,z=t.dailyReturnPercentageQuote,m=f>=0?"#00C853":"#D32F2F",u=f>=0?"+":"",T=o=>{const d=new Date(o*1e3);return r==="1D"?d.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):d.toLocaleDateString("en-US",{month:"short",day:"numeric"})},y=h.map(o=>({...o,timeFormatted:T(o.time)})),b=Math.min(...g),j=Math.max(...g),v=(j-b)*.1,W=[b-v,j+v];return e.jsxs("div",{style:{padding:"24px",fontFamily:"system-ui",maxWidth:"1200px",margin:"0 auto"},children:[e.jsx("div",{style:{marginBottom:"32px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"32px",fontWeight:"bold"},children:i.ticker}),e.jsx("div",{style:{fontSize:"16px",color:"#666",marginTop:"4px"},children:i.companyName})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold"},children:["$",k.toFixed(2)]}),e.jsxs("div",{style:{color:m,fontSize:"18px",fontWeight:"500"},children:[u,"$",Math.abs(f).toFixed(2)," (",u,z.toFixed(2),"%)"]})]})]})}),e.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[e.jsxs("a",{href:`https://trading.hellostake.com/platform/instrument/us-trading/${i.ticker}`,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",padding:"20px 48px",background:"#000",color:"white",fontSize:"24px",fontWeight:"bold",textDecoration:"none",borderRadius:"8px",transition:"all 0.2s ease",cursor:"pointer"},onMouseOver:o=>{o.currentTarget.style.background="#333"},onMouseOut:o=>{o.currentTarget.style.background="#000"},children:["Trade ",i.ticker," on Stake"]}),e.jsx("div",{style:{marginTop:"12px",fontSize:"14px",color:"#666"},children:"Available on Stake - Start trading in minutes"})]}),e.jsxs("div",{style:{marginBottom:"32px",background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"18px",margin:0,fontWeight:"600"},children:"Price Chart"}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:["1D","1W","1M","1Y"].map(o=>e.jsx("button",{onClick:()=>w(o),disabled:s,style:{padding:"8px 16px",border:r===o?"2px solid #000":"1px solid #e0e0e0",background:r===o?"#000":"white",color:r===o?"white":"#666",fontWeight:r===o?"bold":"normal",borderRadius:"8px",cursor:s?"wait":"pointer",fontSize:"14px",transition:"all 0.2s ease",opacity:s?.6:1},children:o},o))})]}),e.jsx(F,{width:"100%",height:350,children:e.jsxs(R,{data:y,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPriceTrading",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:m,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:m,stopOpacity:0})]})}),e.jsx(B,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),e.jsx(D,{dataKey:"timeFormatted",stroke:"#666",tick:{fontSize:11},interval:"preserveStartEnd",tickFormatter:(o,d)=>d%Math.floor(y.length/6)===0?o:""}),e.jsx(L,{stroke:"#666",tick:{fontSize:12},domain:W,tickFormatter:o=>`$${o.toFixed(2)}`}),e.jsx($,{content:e.jsx(P,{})}),e.jsx(O,{type:"monotone",dataKey:"price",stroke:m,strokeWidth:2,fill:"url(#colorPriceTrading)",animationDuration:300})]})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Open"}),e.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold"},children:["$",t.open.toFixed(2)]})]}),e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"High"}),e.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#00C853"},children:["$",t.high.toFixed(2)]})]}),e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Low"}),e.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#D32F2F"},children:["$",t.low.toFixed(2)]})]}),e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Volume"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:t.volume.toLocaleString()})]}),i.marketCap&&e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Market Cap"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:i.marketCap})]}),i.fiftyTwoWeekHigh&&e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"52W High"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:i.fiftyTwoWeekHigh})]})]}),e.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",border:"1px solid #e0e0e0",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"16px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:["Yes, you can trade ",i.ticker," on Stake"]}),e.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Commission-free trading • Real-time market data • Instant deposits"})]})]})},I=()=>{var r;const i=M();x.useEffect(()=>{console.log("[TradingWidget] toolOutput changed:",i)},[i]);const t=(r=i==null?void 0:i.result)==null?void 0:r.structuredContent;if(!t)return e.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"Loading trading information..."}),e.jsx("div",{style:{fontSize:"14px",color:"#999"},children:"Checking stock availability on Stake"})]});if(t.available===!1)return e.jsxs("div",{style:{padding:"60px 40px",textAlign:"center",fontFamily:"system-ui",maxWidth:"600px",margin:"0 auto"},children:[e.jsxs("h2",{style:{fontSize:"28px",fontWeight:"bold",marginBottom:"16px",color:"#333"},children:["Sorry, ",t.stockSymbol," isn't available on Stake"]}),e.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",marginBottom:"32px"},children:"This stock is not currently available for trading on Stake. Try searching for another US-listed stock instead."}),e.jsxs("div",{style:{background:"#f5f5f5",padding:"24px",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px",color:"#666"},children:"Popular stocks available on Stake:"}),e.jsx("div",{style:{display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},children:["AAPL","TSLA","NVDA","MSFT","GOOGL","AMZN","META"].map(n=>e.jsx("div",{style:{padding:"8px 16px",background:"white",border:"1px solid #ddd",borderRadius:"8px",fontSize:"14px",fontWeight:"500",color:"#333"},children:n},n))})]})]});if(!t.stockData||!t.marketData||!t.chartData)return e.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"Loading trading information..."}),e.jsxs("div",{style:{fontSize:"14px",color:"#999"},children:["Fetching data for ",t.stockSymbol,"..."]})]});const a=Array.isArray(t.marketData)?t.marketData[0]:t.marketData;return e.jsx(G,{stockData:t.stockData,marketData:a,chartData:t.chartData})},S=document.getElementById("trading-widget-root");S&&C(S).render(e.jsx(I,{}));
