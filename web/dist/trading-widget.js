import{c as A,j as e,r as x}from"./assets/client-CAizLhZc.js";import{R,A as F,C as D,X as B,Y as $,T as E,a as O}from"./assets/AreaChart-DWmB5lgi.js";function L(i){const[t,s]=x.useState(()=>{var a;return(a=window.openai)==null?void 0:a[i]});return x.useEffect(()=>{const r=h=>{var p;const n=(p=window.openai)==null?void 0:p[i];n!==void 0&&(console.log(`[useOpenAiGlobal] ${i} updated:`,n),s(n))};window.addEventListener("openai:set_globals",r);const a=setInterval(()=>{var n;const l=(n=window.openai)==null?void 0:n[i];l!==void 0&&l!==t&&(console.log(`[useOpenAiGlobal] ${i} found via polling:`,l),s(l),clearInterval(a))},100);return()=>{window.removeEventListener("openai:set_globals",r),clearInterval(a)}},[i,t]),t}function I(){return L("toolOutput")}const M=({active:i,payload:t})=>{if(i&&t&&t.length){const s=t[0].payload,a=new Date(s.time*1e3).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"4px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:a}),e.jsxs("div",{style:{fontSize:"14px",fontWeight:"bold"},children:["$",s.price.toFixed(2)]})]})}return null},P=({stockData:i,marketData:t,chartData:s})=>{const[r,a]=x.useState("1D"),[h,l]=x.useState(s),[n,p]=x.useState(!1),w=async o=>{p(!0),a(o);try{const d=await fetch(`https://hellostake.com/api/us/chart/${i.ticker}/${o}`,{method:"GET",credentials:"include",headers:{Accept:"application/json"}});if(d.ok){const W=(await d.json()).map(c=>({time:c[0]/1e3,price:c[4],open:c[1],high:c[2],low:c[3],volume:c[5]}));l(W)}}catch(d){console.error("Error fetching chart data:",d)}finally{p(!1)}},g=h.map(o=>o.price),k=g[g.length-1]||t.lastTrade,f=t.dailyReturnQuote,T=t.dailyReturnPercentageQuote,m=f>=0?"#00C853":"#D32F2F",u=f>=0?"+":"",z=o=>{const d=new Date(o*1e3);return r==="1D"?d.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):d.toLocaleDateString("en-US",{month:"short",day:"numeric"})},b=h.map(o=>({...o,timeFormatted:z(o.time)})),y=Math.min(...g),j=Math.max(...g),v=(j-y)*.1,C=[y-v,j+v];return e.jsxs("div",{style:{padding:"24px",fontFamily:"system-ui",maxWidth:"1200px",margin:"0 auto"},children:[e.jsx("div",{style:{marginBottom:"32px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"32px",fontWeight:"bold"},children:i.ticker}),e.jsx("div",{style:{fontSize:"16px",color:"#666",marginTop:"4px"},children:i.companyName})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold"},children:["$",k.toFixed(2)]}),e.jsxs("div",{style:{color:m,fontSize:"18px",fontWeight:"500"},children:[u,"$",Math.abs(f).toFixed(2)," (",u,T.toFixed(2),"%)"]})]})]})}),e.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[e.jsxs("a",{href:`https://trading.hellostake.com/platform/instrument/us-trading/${i.ticker}`,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",padding:"20px 48px",background:"linear-gradient(135deg, #00C853 0%, #00E676 100%)",color:"white",fontSize:"24px",fontWeight:"bold",textDecoration:"none",borderRadius:"16px",boxShadow:"0 6px 20px rgba(0, 200, 83, 0.4)",transition:"all 0.2s ease",cursor:"pointer"},onMouseOver:o=>{o.currentTarget.style.transform="translateY(-3px)",o.currentTarget.style.boxShadow="0 8px 24px rgba(0, 200, 83, 0.5)"},onMouseOut:o=>{o.currentTarget.style.transform="translateY(0)",o.currentTarget.style.boxShadow="0 6px 20px rgba(0, 200, 83, 0.4)"},children:["ðŸš€ Trade ",i.ticker," now on Stake"]}),e.jsx("div",{style:{marginTop:"12px",fontSize:"14px",color:"#666"},children:"Available on Stake - Start trading in minutes"})]}),e.jsxs("div",{style:{marginBottom:"32px",background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"18px",margin:0,fontWeight:"600"},children:"Price Chart"}),e.jsx("div",{style:{display:"flex",gap:"8px"},children:["1D","1W","1M","1Y"].map(o=>e.jsx("button",{onClick:()=>w(o),disabled:n,style:{padding:"8px 16px",border:r===o?"2px solid #00C853":"1px solid #e0e0e0",background:r===o?"#f0fdf4":"white",color:r===o?"#00C853":"#666",fontWeight:r===o?"bold":"normal",borderRadius:"8px",cursor:n?"wait":"pointer",fontSize:"14px",transition:"all 0.2s ease",opacity:n?.6:1},children:o},o))})]}),e.jsx(R,{width:"100%",height:350,children:e.jsxs(F,{data:b,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPriceTrading",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:m,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:m,stopOpacity:0})]})}),e.jsx(D,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),e.jsx(B,{dataKey:"timeFormatted",stroke:"#666",tick:{fontSize:11},interval:"preserveStartEnd",tickFormatter:(o,d)=>d%Math.floor(b.length/6)===0?o:""}),e.jsx($,{stroke:"#666",tick:{fontSize:12},domain:C,tickFormatter:o=>`$${o.toFixed(2)}`}),e.jsx(E,{content:e.jsx(M,{})}),e.jsx(O,{type:"monotone",dataKey:"price",stroke:m,strokeWidth:2,fill:"url(#colorPriceTrading)",animationDuration:300})]})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Open"}),e.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold"},children:["$",t.open.toFixed(2)]})]}),e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"High"}),e.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#00C853"},children:["$",t.high.toFixed(2)]})]}),e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Low"}),e.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#D32F2F"},children:["$",t.low.toFixed(2)]})]}),e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Volume"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:t.volume.toLocaleString()})]}),i.marketCap&&e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"Market Cap"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:i.marketCap})]}),i.fiftyTwoWeekHigh&&e.jsxs("div",{style:{padding:"20px",background:"white",border:"1px solid #e0e0e0",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textTransform:"uppercase"},children:"52W High"}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:i.fiftyTwoWeekHigh})]})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, #f0fdf4 0%, #e8f5e9 100%)",padding:"20px",borderRadius:"12px",border:"1px solid #c8e6c9",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"16px",fontWeight:"600",color:"#2e7d32",marginBottom:"8px"},children:["âœ“ Yes, you can trade ",i.ticker," on Stake!"]}),e.jsx("div",{style:{fontSize:"14px",color:"#558b2f"},children:"Commission-free trading â€¢ Real-time market data â€¢ Instant deposits"})]})]})},G=()=>{var r;const i=I();x.useEffect(()=>{console.log("[TradingWidget] toolOutput changed:",i)},[i]);const t=(r=i==null?void 0:i.result)==null?void 0:r.structuredContent;if(!t||!t.stockData||!t.marketData||!t.chartData)return e.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"Loading trading information..."}),e.jsxs("div",{style:{fontSize:"14px",color:"#999"},children:["Checking if ",(t==null?void 0:t.stockSymbol)||"this stock"," is available on Stake"]})]});const s=Array.isArray(t.marketData)?t.marketData[0]:t.marketData;return e.jsx(P,{stockData:t.stockData,marketData:s,chartData:t.chartData})},S=document.getElementById("trading-widget-root");S&&A(S).render(e.jsx(G,{}));
