import{c as x,j as t,r as p}from"./assets/client-CAizLhZc.js";function c(s){const[e,o]=p.useState(()=>{var l;return(l=window.openai)==null?void 0:l[s]});return p.useEffect(()=>{const n=r=>{var a;const i=(a=window.openai)==null?void 0:a[s];i!==void 0&&(console.log(`[useOpenAiGlobal] ${s} updated:`,i),o(i))};window.addEventListener("openai:set_globals",n);const l=setInterval(()=>{var i;const d=(i=window.openai)==null?void 0:i[s];d!==void 0&&d!==e&&(console.log(`[useOpenAiGlobal] ${s} found via polling:`,d),o(d),clearInterval(l))},100);return()=>{window.removeEventListener("openai:set_globals",n),clearInterval(l)}},[s,e]),e}function g(){return c("toolInput")}function h(){return c("toolOutput")}function y(){const s=window;return{toolOutput:c("toolOutput"),toolInput:c("toolInput"),callTool:(e,o)=>{var n,l;console.log("[callTool]",e,o),(l=(n=s.openai)==null?void 0:n.callTool)==null||l.call(n,e,o)},sendFollowUpMessage:e=>{var o,n;console.log("[sendFollowUpMessage]",e),(n=(o=s.openai)==null?void 0:o.sendFollowUpMessage)==null||n.call(o,e)},requestDisplayMode:e=>{var o,n;console.log("[requestDisplayMode]",e),(n=(o=s.openai)==null?void 0:o.requestDisplayMode)==null||n.call(o,e)},openExternal:e=>{var o,n;console.log("[openExternal]",e),(n=(o=s.openai)==null?void 0:o.openExternal)==null||n.call(o,e)},setWidgetState:e=>{var o,n;console.log("[setWidgetState]",e),(n=(o=s.openai)==null?void 0:o.setWidgetState)==null||n.call(o,e)},getWidgetState:()=>{var o;const e=(o=s.openai)==null?void 0:o.widgetState;return console.log("[getWidgetState]",e),e}}}const f=({stockData:s,marketData:e})=>{const o=e.dailyReturnQuote>=0?"#00C853":"#D32F2F",n=e.dailyReturnQuote>=0?"+":"";return t.jsxs("div",{style:{padding:"20px",fontFamily:"system-ui"},children:[t.jsx("h2",{children:s.ticker}),t.jsx("div",{style:{fontSize:"18px",color:"#666",marginBottom:"20px"},children:s.companyName}),t.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[t.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Current Price"}),t.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",margin:"8px 0"},children:["$",e.lastTrade]}),t.jsxs("div",{style:{color:o,fontSize:"18px"},children:[n,e.dailyReturnQuote," (",n,e.dailyReturnPercentageQuote,"%)"]})]}),t.jsxs("div",{style:{marginTop:"20px",padding:"16px",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[t.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"16px"},children:"Market Data"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"Open"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.open]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"High"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.high]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"Low"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.low]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#666"},children:"Volume"}),t.jsx("span",{style:{fontWeight:"bold"},children:e.volume.toLocaleString()})]})]})]})},b=()=>{var i;const s=h(),e=g(),[o,n]=p.useState(null),l=y();if(p.useEffect(()=>{console.log("[ImprovedApp] toolOutput changed:",s),console.log("[ImprovedApp] toolInput:",e)},[s,e]),o)return t.jsx("div",{style:{padding:"20px",color:"#D32F2F"},children:o});const r=(i=s==null?void 0:s.result)==null?void 0:i.structuredContent;if(!r||!r.stockData||!r.marketData)return t.jsxs("div",{style:{padding:"20px"},children:[t.jsx("div",{children:"Loading share details..."}),t.jsx("div",{style:{fontSize:"12px",color:"#999",marginTop:"8px"},children:"Waiting for data from MCP server"})]});const d=Array.isArray(r.marketData)?r.marketData[0]:r.marketData;return t.jsxs(t.Fragment,{children:[t.jsx(f,{stockData:r.stockData,marketData:d}),t.jsx("div",{style:{padding:"20px",borderTop:"1px solid #e0e0e0",textAlign:"center"},children:t.jsxs("a",{href:`https://trading.hellostake.com/platform/instrument/us-trading/${r.stockData.ticker}`,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",padding:"16px 32px",background:"linear-gradient(135deg, #00C853 0%, #00E676 100%)",color:"white",fontSize:"18px",fontWeight:"bold",textDecoration:"none",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 200, 83, 0.3)",transition:"all 0.2s ease",cursor:"pointer",marginBottom:"16px"},onMouseOver:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="0 6px 16px rgba(0, 200, 83, 0.4)"},onMouseOut:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="0 4px 12px rgba(0, 200, 83, 0.3)"},children:["ðŸš€ Trade ",r.stockData.ticker," now on Stake"]})}),t.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #e0e0e0"},children:[t.jsx("button",{onClick:()=>l.requestDisplayMode("fullscreen"),style:{padding:"8px 16px",marginRight:"8px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"white"},children:"View Fullscreen"}),t.jsx("button",{onClick:()=>l.sendFollowUpMessage(`Tell me more about ${r.stockData.ticker}`),style:{padding:"8px 16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"white"},children:"Ask ChatGPT About This Stock"})]})]})},u=document.getElementById("share-detail-root");u&&x(u).render(t.jsx(b,{}));
