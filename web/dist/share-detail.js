import{c as x,j as t,r as d}from"./assets/client-DXcH-vAE.js";function a(n){const[e,o]=d.useState(()=>{var l;return(l=window.openai)==null?void 0:l[n]});return d.useEffect(()=>{const s=p=>{var c;const i=(c=window.openai)==null?void 0:c[n];i!==void 0&&(console.log(`[useOpenAiGlobal] ${n} updated:`,i),o(i))};window.addEventListener("openai:set_globals",s);const l=setInterval(()=>{var i;const r=(i=window.openai)==null?void 0:i[n];r!==void 0&&r!==e&&(console.log(`[useOpenAiGlobal] ${n} found via polling:`,r),o(r),clearInterval(l))},100);return()=>{window.removeEventListener("openai:set_globals",s),clearInterval(l)}},[n,e]),e}function g(){return a("toolInput")}function h(){return a("toolOutput")}function y(){const n=window;return{toolOutput:a("toolOutput"),toolInput:a("toolInput"),callTool:(e,o)=>{var s,l;console.log("[callTool]",e,o),(l=(s=n.openai)==null?void 0:s.callTool)==null||l.call(s,e,o)},sendFollowUpMessage:e=>{var o,s;console.log("[sendFollowUpMessage]",e),(s=(o=n.openai)==null?void 0:o.sendFollowUpMessage)==null||s.call(o,e)},requestDisplayMode:e=>{var o,s;console.log("[requestDisplayMode]",e),(s=(o=n.openai)==null?void 0:o.requestDisplayMode)==null||s.call(o,e)},openExternal:e=>{var o,s;console.log("[openExternal]",e),(s=(o=n.openai)==null?void 0:o.openExternal)==null||s.call(o,e)},setWidgetState:e=>{var o,s;console.log("[setWidgetState]",e),(s=(o=n.openai)==null?void 0:o.setWidgetState)==null||s.call(o,e)},getWidgetState:()=>{var o;const e=(o=n.openai)==null?void 0:o.widgetState;return console.log("[getWidgetState]",e),e}}}const f=({stockData:n,marketData:e})=>{const o=e.dailyReturnQuote>=0?"#00C853":"#D32F2F",s=e.dailyReturnQuote>=0?"+":"";return t.jsxs("div",{style:{padding:"20px",fontFamily:"system-ui"},children:[t.jsx("h2",{children:n.ticker}),t.jsx("div",{style:{fontSize:"18px",color:"#666",marginBottom:"20px"},children:n.companyName}),t.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[t.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Current Price"}),t.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",margin:"8px 0"},children:["$",e.lastTrade]}),t.jsxs("div",{style:{color:o,fontSize:"18px"},children:[s,e.dailyReturnQuote," (",s,e.dailyReturnPercentageQuote,"%)"]})]}),t.jsxs("div",{style:{marginTop:"20px",padding:"16px",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[t.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"16px"},children:"Market Data"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"Open"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.open]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"High"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.high]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"Low"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.low]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#666"},children:"Volume"}),t.jsx("span",{style:{fontWeight:"bold"},children:e.volume.toLocaleString()})]})]})]})},j=()=>{const n=h(),e=g(),[o,s]=d.useState(null),l=y();if(d.useEffect(()=>{console.log("[ImprovedApp] toolOutput changed:",n),console.log("[ImprovedApp] toolInput:",e)},[n,e]),o)return t.jsx("div",{style:{padding:"20px",color:"#D32F2F"},children:o});if(!n||!n.stockData||!n.marketData)return t.jsxs("div",{style:{padding:"20px"},children:[t.jsx("div",{children:"Loading share details..."}),t.jsx("div",{style:{fontSize:"12px",color:"#999",marginTop:"8px"},children:"Waiting for data from MCP server"})]});const p=Array.isArray(n.marketData)?n.marketData[0]:n.marketData;return t.jsxs(t.Fragment,{children:[t.jsx(f,{stockData:n.stockData,marketData:p}),t.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #e0e0e0"},children:[t.jsx("button",{onClick:()=>l.requestDisplayMode("fullscreen"),style:{padding:"8px 16px",marginRight:"8px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"white"},children:"View Fullscreen"}),t.jsx("button",{onClick:()=>l.sendFollowUpMessage(`Tell me more about ${n.stockData.ticker}`),style:{padding:"8px 16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"white"},children:"Ask ChatGPT About This Stock"})]})]})},u=document.getElementById("share-detail-root");u&&x(u).render(t.jsx(j,{}));
