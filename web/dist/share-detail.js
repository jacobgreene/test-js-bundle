import{c as x,j as t,r as a}from"./assets/client-DXcH-vAE.js";function p(s){const[e,o]=a.useState(()=>{var l;return(l=window.openai)==null?void 0:l[s]});return a.useEffect(()=>{const n=i=>{var c;const r=(c=window.openai)==null?void 0:c[s];r!==void 0&&(console.log(`[useOpenAiGlobal] ${s} updated:`,r),o(r))};window.addEventListener("openai:set_globals",n);const l=setInterval(()=>{var r;const d=(r=window.openai)==null?void 0:r[s];d!==void 0&&d!==e&&(console.log(`[useOpenAiGlobal] ${s} found via polling:`,d),o(d),clearInterval(l))},100);return()=>{window.removeEventListener("openai:set_globals",n),clearInterval(l)}},[s,e]),e}function g(){return p("toolInput")}function h(){return p("toolOutput")}function y(){const s=window;return{toolOutput:p("toolOutput"),toolInput:p("toolInput"),callTool:(e,o)=>{var n,l;console.log("[callTool]",e,o),(l=(n=s.openai)==null?void 0:n.callTool)==null||l.call(n,e,o)},sendFollowUpMessage:e=>{var o,n;console.log("[sendFollowUpMessage]",e),(n=(o=s.openai)==null?void 0:o.sendFollowUpMessage)==null||n.call(o,e)},requestDisplayMode:e=>{var o,n;console.log("[requestDisplayMode]",e),(n=(o=s.openai)==null?void 0:o.requestDisplayMode)==null||n.call(o,e)},openExternal:e=>{var o,n;console.log("[openExternal]",e),(n=(o=s.openai)==null?void 0:o.openExternal)==null||n.call(o,e)},setWidgetState:e=>{var o,n;console.log("[setWidgetState]",e),(n=(o=s.openai)==null?void 0:o.setWidgetState)==null||n.call(o,e)},getWidgetState:()=>{var o;const e=(o=s.openai)==null?void 0:o.widgetState;return console.log("[getWidgetState]",e),e}}}const f=({stockData:s,marketData:e})=>{const o=e.dailyReturnQuote>=0?"#00C853":"#D32F2F",n=e.dailyReturnQuote>=0?"+":"";return t.jsxs("div",{style:{padding:"20px",fontFamily:"system-ui"},children:[t.jsx("h2",{children:s.ticker}),t.jsx("div",{style:{fontSize:"18px",color:"#666",marginBottom:"20px"},children:s.companyName}),t.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[t.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Current Price"}),t.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",margin:"8px 0"},children:["$",e.lastTrade]}),t.jsxs("div",{style:{color:o,fontSize:"18px"},children:[n,e.dailyReturnQuote," (",n,e.dailyReturnPercentageQuote,"%)"]})]}),t.jsxs("div",{style:{marginTop:"20px",padding:"16px",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[t.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"16px"},children:"Market Data"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"Open"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.open]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"High"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.high]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:"#666"},children:"Low"}),t.jsxs("span",{style:{fontWeight:"bold"},children:["$",e.low]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#666"},children:"Volume"}),t.jsx("span",{style:{fontWeight:"bold"},children:e.volume.toLocaleString()})]})]})]})},j=()=>{var r;const s=h(),e=g(),[o,n]=a.useState(null),l=y();if(a.useEffect(()=>{console.log("[ImprovedApp] toolOutput changed:",s),console.log("[ImprovedApp] toolInput:",e)},[s,e]),o)return t.jsx("div",{style:{padding:"20px",color:"#D32F2F"},children:o});const i=(r=s==null?void 0:s.result)==null?void 0:r.structuredContent;if(!i||!i.stockData||!i.marketData)return t.jsxs("div",{style:{padding:"20px"},children:[t.jsx("div",{children:"Loading share details..."}),t.jsx("div",{style:{fontSize:"12px",color:"#999",marginTop:"8px"},children:"Waiting for data from MCP server"})]});const d=Array.isArray(i.marketData)?i.marketData[0]:i.marketData;return t.jsxs(t.Fragment,{children:[t.jsx(f,{stockData:i.stockData,marketData:d}),t.jsxs("div",{style:{padding:"20px",borderTop:"1px solid #e0e0e0"},children:[t.jsx("button",{onClick:()=>l.requestDisplayMode("fullscreen"),style:{padding:"8px 16px",marginRight:"8px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"white"},children:"View Fullscreen"}),t.jsx("button",{onClick:()=>l.sendFollowUpMessage(`Tell me more about ${s.stockData.ticker}`),style:{padding:"8px 16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"white"},children:"Ask ChatGPT About This Stock"})]})]})},u=document.getElementById("share-detail-root");u&&x(u).render(t.jsx(j,{}));
