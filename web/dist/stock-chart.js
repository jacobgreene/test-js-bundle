import{c as f,j as t,r as c}from"./assets/client-DXcH-vAE.js";function v(i){const[l,a]=c.useState(()=>{var o;return(o=window.openai)==null?void 0:o[i]});return c.useEffect(()=>{const e=s=>{var d;const r=(d=window.openai)==null?void 0:d[i];r!==void 0&&(console.log(`[useOpenAiGlobal] ${i} updated:`,r),a(r))};window.addEventListener("openai:set_globals",e);const o=setInterval(()=>{var r;const n=(r=window.openai)==null?void 0:r[i];n!==void 0&&n!==l&&(console.log(`[useOpenAiGlobal] ${i} found via polling:`,n),a(n),clearInterval(o))},100);return()=>{window.removeEventListener("openai:set_globals",e),clearInterval(o)}},[i,l]),l}function m(){return v("toolOutput")}const j=({stockData:i,chartData:l})=>{const a=l.map(u=>u.price),e=a[a.length-1]||0,o=a[0]||0,s=Math.max(...a),n=Math.min(...a),r=e-o,d=o>0?r/o*100:0,p=r>=0?"#00C853":"#D32F2F",x=r>=0?"+":"",g=s>n?(e-n)/(s-n)*100:50;return t.jsxs("div",{style:{padding:"20px",fontFamily:"system-ui"},children:[t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("h2",{style:{margin:0},children:i.ticker}),t.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"4px"},children:i.companyName})]}),t.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"24px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"Current Price"}),t.jsxs("div",{style:{fontSize:"42px",fontWeight:"bold",marginBottom:"8px"},children:["$",e.toFixed(2)]}),t.jsxs("div",{style:{color:p,fontSize:"20px"},children:[x,"$",Math.abs(r).toFixed(2)," (",x,d.toFixed(2),"%)"]})]}),t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx("h3",{style:{fontSize:"16px",marginBottom:"16px"},children:"Today's Price Range"}),t.jsxs("div",{style:{position:"relative",height:"200px",background:"#fafafa",borderRadius:"8px",padding:"16px"},children:[t.jsxs("div",{style:{position:"absolute",left:"16px",top:"16px",fontSize:"12px",color:"#666"},children:["$",s.toFixed(2)]}),t.jsxs("div",{style:{position:"absolute",left:"16px",bottom:"16px",fontSize:"12px",color:"#666"},children:["$",n.toFixed(2)]}),t.jsxs("div",{style:{marginLeft:"60px",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:[t.jsx("div",{style:{height:"4px",background:"#e0e0e0",borderRadius:"2px"},children:t.jsx("div",{style:{position:"absolute",right:"0",fontSize:"12px",color:"#666",transform:"translateY(-50%)"},children:"High"})}),t.jsx("div",{style:{position:"absolute",top:`${100-g}%`,left:"60px",right:"0",height:"8px",background:p,borderRadius:"4px",transform:"translateY(-50%)"},children:t.jsxs("div",{style:{position:"absolute",right:"0",fontSize:"12px",color:p,fontWeight:"bold",transform:"translateY(-150%)"},children:["Current: $",e.toFixed(2)]})}),t.jsx("div",{style:{height:"4px",background:"#e0e0e0",borderRadius:"2px"},children:t.jsx("div",{style:{position:"absolute",right:"0",bottom:"0",fontSize:"12px",color:"#666",transform:"translateY(50%)"},children:"Low"})}),t.jsx("div",{style:{position:"absolute",top:`${100-(o-n)/(s-n)*100}%`,left:"60px",width:"40px",height:"2px",background:"#2196F3",transform:"translateY(-50%)"},children:t.jsxs("div",{style:{position:"absolute",left:"-50px",fontSize:"11px",color:"#2196F3",transform:"translateY(-50%)"},children:["Open: $",o.toFixed(2)]})})]})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsxs("div",{style:{padding:"16px",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[t.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Data Points"}),t.jsx("div",{style:{fontSize:"18px",fontWeight:"bold"},children:l.length})]}),t.jsxs("div",{style:{padding:"16px",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[t.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Day Range"}),t.jsxs("div",{style:{fontSize:"18px",fontWeight:"bold"},children:["$",(s-n).toFixed(2)]})]})]}),t.jsxs("div",{style:{marginTop:"20px",padding:"12px",background:"#e3f2fd",borderRadius:"8px",fontSize:"13px",color:"#1976d2"},children:["ðŸ’¡ This is a simple chart. For production, consider using:",t.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px"},children:[t.jsx("li",{children:"Recharts (lightweight)"}),t.jsx("li",{children:"Chart.js (popular)"}),t.jsx("li",{children:"TradingView (professional)"}),t.jsx("li",{children:"Lightweight Charts (by TradingView)"})]})]})]})},y=()=>{var s;const i=m(),[l,a]=c.useState(null);if(c.useEffect(()=>{console.log("[StockChart] toolOutput changed:",i)},[i]),l)return t.jsx("div",{style:{padding:"20px",color:"#D32F2F"},children:l});const e=(s=i==null?void 0:i.result)==null?void 0:s.structuredContent;if(!e||!e.stockData||!e.chartData)return t.jsxs("div",{style:{padding:"20px"},children:[t.jsx("div",{children:"Loading stock chart..."}),t.jsx("div",{style:{fontSize:"12px",color:"#999",marginTop:"8px"},children:"Waiting for chart data from MCP server"})]});const o=Array.isArray(e.chartData)?e.chartData:[];return o.length===0?t.jsxs("div",{style:{padding:"20px",color:"#D32F2F"},children:["No chart data available for ",e.stockData.ticker]}):t.jsx(j,{stockData:e.stockData,chartData:o})},h=document.getElementById("stock-chart-root");h&&f(h).render(t.jsx(y,{}));
